# CS130 Assignment 9

## Implemented Features
* Markdown -> HTML rendering
* S3 Bucket Storage

## Markdown -> HTML Rendering
* This page is written in Markdown!
* To see this page's raw text, [click here](http://richardm.in/CS130/serve/design_doc_markdown.md)

## Design Decisions
* Separate handler, because you may want to have both markdown served as HTML and raw (i.e. github has RAW setting)
    * The other choice here was to make it an option, but would configure for the entire endpoint
* Serve non-markdown files normally because otherwise lots of endpoint switching is involved


The feature allows the server to serve files store on AWS S3

# AWS Cloud Buckets

## Requirement: 
Python 2.X
```
pip install boto3
```
*After installing boto3, first make sure the bucket in use allows access by configuring the 
bucket policy. 
*Then you need to configure the accesskeys in the environment for the S3
bucket: https://boto3.readthedocs.io/en/latest/guide/quickstart.html#installation

## Basic Idea:
There is a CloudFileHandler that extracts the filename from the request uri, use a system call to
run a Python script to download the file from the S3 bucket specified in the config file, return 
the content in HttpResponse and delete the temporary downloaded file. 

## Specify the CloudFileHandler in the config File:
```
path /cloud CloudFileHandler {
        bucket  your_bucket;
}
```
where /cloud is the prefix, your_bucket is our S3 bucket.

## Getting files from the cloud:
* If the request uri is /cloud/test.txt, the CloudFileHandler will pass test.txt to s3_get_file.py
* If found, the script downloads the file and the handler returns the content in HttpResPonse
* If not found, it returns an error code and the handler returns 404
The temporary downloads will be deleted after the response

## Concurrency:
The files downloaded from the cloud need to have different names or otherwise there will be issues.
The names are generated by GenerateName method. For now the CloudFileHandler class has a static counter 
that is guarded by a mutex. The counter is set to 0 when the class is initiated and incremented each time
GenerateName is called

## Future direction:
* 1. Instead of using system calls to execute Pyhton scripts, embed the Python interpreter.
* 2. May use pipes for the file transfers.


# Demo showing markdown features:

# H1 Example
## H2 Example
### H3 Example
#### H4 Example
##### H5 Example
###### H6 Example
``` code block ```

Alt-H1 Style
============

Alt-H2 Style
------------

Emphasis, aka italics, with *asterisks* or _underscores_.

Strong emphasis, aka bold, with **asterisks** or __underscores__.

1. First ordered list item
2. Another item
    * Unordered sub-list. 
1. Actual numbers don't matter, just that it's a number
    1. Ordered sub-list
4. And another item.

> Blockquotes are very handy in email to emulate reply text.
> This line is part of the same quote.

Quote break.

> This is a very long line that will still be quoted properly when it wraps. Oh boy let's keep writing to make sure this is long enough to actually wrap for everyone. Oh, you can *put* **Markdown** into a blockquote. 

Three or more...

---

Hyphens

***

Asterisks

___

Underscores

Markdown Examples courtesy of [this link](https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet)
